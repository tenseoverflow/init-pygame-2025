![Fruit Ninja - init2025 edition](assets/icon.png "Fruit Ninja - init2025 edition")

# Fruit Ninja - init2025 edition

- [Abivahendid](#abivahendid)
- [Sissejuhatus](#sissejuhatus)
- [√úlesanded](#%C3%BClesanded)
    - [üêç PyGame paigaldamine](#-pygame-paigaldamine)
    - [üçâ Puuviljade loomine](#-puuviljade-loomine)
    - [‚úÇÔ∏è Puuviljade l√µikamine](#-puuviljade-l%C3%B5ikamine)
    - [üí• Pommi lisamine](#-pommide-lisamine)
    - [üî¢ Skoori arvutamine](#-skoori-arvutamine)
    - [üîä Heliefektide lisamine](#-heliefektide-lisamine)
    - [‚≠ê Boonus√ºlesanded](#-boonus%C3%BClesanded)

## Abivahendid

K√µige olulisem abivahend selles t√∂√∂toas on **oskus k√ºsida k√ºsimusi**. K√ºsimusi soovitame julgelt k√ºsida klassis ringi
liikuvate **abi√µppej√µudude k√§est**, kes on valmis vastama k√µikidele k√ºsimustele. Kui abi√µppej√µud ei oska aidata, v√µid
kasutada ka [**Dr. Google'it**](https://google.ee), [PyGame dokumentatsiooni](https://www.pygame.org/docs/) v√µi meie
projekti kaustas [`solutions`](https://github.com/taltech-coding/init-pygame-2025/tree/main/solutions) olevaid
lahendusi. Tunnis kasutatud slaidiesitlust saab j√§rele
vaadata [siit](https://docs.google.com/presentation/d/1Tx6Us4cHqSNCZh6fkEnREpzOUHxgPIb2akcuWgAFb8Q/edit)!

## Sissejuhatus

Oled praktikant ja sinu √ºlesandeks on anda viimane lihv tulevasele AAAA m√§ngule **"Fruit Ninja - init2025 edition"**!

Aga oh ei - osa koodi on kogemata kaduma l√§inud, sest √ºks t√∂√∂taja unustas muudatused salvestamata! √ïnneks on alles
varasemad arendaja juhised dokumentatsioonis, mis aitavad sul m√§ngu taastada ja √µigeks ajaks Steami √ºles laadida!

M√§ng on loodud [PyGame](https://www.pygame.org/docs/) abil.

## √úlesanded

Oleme sulle ette valmistanud √ºlesanded ning juhtn√∂√∂rid nende lahendamiseks. Kui vajad abi, t√µsta julgelt k√§si v√µi kasuta
Dr. Google'it! Peamine eesm√§rk on **√µppida ja l√µbutseda!** üéÆ

### üêç PyGame paigaldamine

Enne koodi kirjutamist peame PyGame paigaldama. Avame koodit√∂√∂tlusprogrammi (nt PyCharm), laadime alla projekti koodi ja
avame terminali (`>_`). Seej√§rel k√§ivitame k√§su:

```sh
pip install pygame
```

Kui tekib probleeme, k√ºsi julgelt abi!

### üçâ Puuviljade loomine

1. **Puuviljad peaksid ilmuma juhuslikult ekraani alumisse serva.**
   Mine faili `fruit_ninja.py` ja otsi sealt √ºles funktsioon `spawn_fruit()`.

   Kui `spawn_fruit()` funktsioon k√§ivitatakse, m√§√§ratakse igale uuele puuviljale t√º√ºp, alguspunkt ja trajektoor.

    - Puuvilja t√º√ºp valitakse juhuslikult s√µnastikust `fruit_images`, kasutades selleks funktsiooni `random.choice()`.
    - Alguspunkt `x` m√§√§ratakse vahemikus `150` kuni `SCREEN_WIDTH - 150`, et need ei ilmuks liiga l√§hedale servadele.
      `y` koordinaat seatakse alati v√§√§rtusele `SCREEN_HEIGHT`, et puuviljad ilmuksid ekraani allservas.
    - Liikumise trajektoor koosneb horisontaalsest kiirusest, mille v√§√§rtus v√µib olla `-2` v√µi `2`, ning vertikaalsest
      kiirusest, mis j√§√§b vahemikku `-20` kuni `-18`.

   Kui see funktsioon v√§lja kutsutakse, siis tuleks luua uus `Fruit` objekt. Sellele objektile peab argumentidena
   kaasa andma eelnevalt v√§lja arvutatud `fruit_type`, `x`, `y` ja `trajectory` v√§√§rtused. L√µpuks tuleb vastloodud
   Fruit objekt lisada `self.fruits` nimekirja.

    <details>
    <summary>üí° Kuidas luua uusi muutujaid ja objekte Pythonis?</summary>

```py

# Loome muutuja 'fruit_type' ja m√§√§rame selle v√§√§rtuseks "apple".
fruit_type = "apple"
x = 200  # m√§√§rame koordinaadi x-teljele
y = 600  # m√§√§rame koordinaadi y-teljele
trajectory = (-2, -19)  # m√§√§rame liikumise trajektoori

# Loome 'Fruit' objekti, kasutades eelnevalt m√§√§ratud muutujaid.
new_fruit = Fruit(fruit_type, x, y, trajectory)

# Lisame objekti nimekirja, et seda saaks m√§ngus kasutada.
fruits.append(new_fruit)
```

</details>

### üçè Puuviljade liikumine

1. **Puuviljade liikumise arvutamine**

   Puuviljad peaksid lendama √ºles, ja seej√§rel taas gravitatsiooni m√µjul alla kukkuma!

   K√µigepealt mine faili `constants.py` ja defineeri gravitatsioonikonstant.

   Loo muutuja (konstant) `GRAVITY` ja anna sellele v√§√§rtuseks `0.3`, et simuleerida raskusj√µudu. V√µid muidugi seda
   v√§√§rtust timmida, et m√§ngu huvitavamaks muuta. üòâ

   N√º√ºd otsi √ºles fail `fruit.py`. Selles failis on kirjas kogu puuviljadega seonduv loogika. Hakkame muutma puuvilja
   koordinaate, kasutades selleks varem mainitud trajektoori v√§√§rtusi.

   Iga kaader kutsutakse v√§lja `def move()` funktsiooni. Sinna alla pead kirjutama puuvilja liikumise koodi!

   Esimene trajektoorielement (`self.trajectory[0]`) n√§itab puuvilja liikumise kiirust X-telje suhtes. Seega tuleks
   igal kaadril liita `self.x`-ile (puuvilja X-koordinaadile) `self.trajectory[0]` (puuvilja kiirust X-telje suhtes).
   Teine trajektoorielement (`self.trajectory[1]`) n√§itab j√§relikult puuvilja liikumise kiirust Y-telje suhtes, ning
   tema v√§√§rtus tuleks igal kaadril liita `self.y`-ile (puuvilja Y-koordinaadile).

   Proovi p√§rast nende muudatuste tegemist m√§ngu k√§ima panna! Ava PyCharmis fail `fruit_ninja.py`, vajuta ‚ñ∂Ô∏è play
   nupule, ning n√§ed, et m√§ngu alustades lendavad n√º√ºd ringi puuviljad!

   Aga nagu t√§helepanelik uudistaja kindlasti m√§rkab, siis puuviljad lendavad ekraanil ainult √ºlespoole. Et seda viga
   parandada, kasutame varem loodud gravitatsioonikonstanti, et uuendada trajektoori. Muudame igal kaadril trajektoori
   v√§√§rtust nii, et j√§tame esimese v√§√§rtuse (`self.trajectory[0]`) samaks, kuid liidame teisele v√§√§rtusele
   (`self.trajectory[1]`) otsa `GRAVITY`. Uue trajektoori salvestamiseks saame kasutada koodirida
   `self.trajectory = (esimene v√§√§rtus, teine v√§√§rtus)`.

    <details>
    <summary>üí° Kuidas luua, liita ja lahutada muutujaid Python-is?</summary>
   
    ```py
    # Loome muutuja 'x', ning seame selle v√§√§rtuseks 0.
    x = 1
    x += 5  # muutujale viie liitmine
            # x on n√º√ºd 1 + 5 = 6
    x -= 2  # muutujast kahe lahutamine
            # x on n√º√ºd 6 - 2 = 4
    # saad ka liita m√µne muu muutuja v√µrra
    teine_muutuja = 5
    x += teine_muutuja
    # x on n√º√ºd 4 + teine_muutuja = 4 + 5 = 9
    ```
    </details>


2. **Puuviljade keerlemise arvutamine**

   Puuviljad peaksid m√§ngus visuaalselt p√∂√∂rlema. Selleks tuleb igal kaadril nende p√∂√∂rdenurka uuendada.

   Mine taaskord faili `fruit.py`, ning leia sealt funktsioon `def move()`, kus toimub puuviljade liikumise m√§√§ramine.

   Kuna seda funktsiooni kutsutakse v√§lja igal kaadril, siis puuvilja p√∂√∂rlema panemiseks piisab sellest, kui siinkohal
   `self.angle` v√§√§rtusele (puuvilja praegune p√∂√∂rdenurk) liita juurde `self.rotate_direction` (samas failis veidi
   √ºlevalpool defineeritud muutuja, mis m√§√§rab suvaliselt puuvilja p√∂√∂rlemise suuna ja kiiruse).

### üçâ Skoori arvutamine

Kui puuvili on pooleks l√µigatud, siis peaksime m√§ngijale lisama juurde √ºhe punkti.

Mine faili `fruit_ninja.py` ja otsi √ºles `def handle_slicing()` funktsioon, mis vastutab puuviljade l√µikamise loogika
eest.

Kui puuvili on pooleks l√µigatud, siis lisa `self.score` v√§√§rtusele +1, et arvestada iga l√µigatud puuvilja eest m√§ngijale
punkt.

Kui tahad oma m√§ngu huvitavamaks muuta, siis v√µid siinkohal kasutada ka mingit teistsugust skoorinumbrit!

### üí• Pommi l√µikamine

Kui m√§ngija l√µikab pommi, siis kaotab m√§ngija k√µik oma elud ja m√§ng tuleb kohe l√µpetada.

Mine uuesti faili `fruit_ninja.py` ja otsi taaskord √ºles `def handle_slicing()` funktsioon, kus pesitseb puuviljade ja
pommide l√µikamise loogika.

Kui l√µigatud objekt on pomm, siis:

1. Seadke m√§ngija elud (`self.lives`) nulli.
2. M√§√§rake m√§ngu oleku (`self.state`) v√§√§rtuseks `STATE_GAME_OVER`, et n√§idata, et m√§ng on l√§bi.
3. T√ºhjendage puuviljade nimekiri (`self.fruits`), et ei oleks v√µimalik p√§rast m√§ngu l√µppu enam m√§ngija skoori
   suurendada.

### üíî Kaotusseisu tuvastamine

Praegu oleme m√§√§ranud, et m√§ng l√µppeb, kui m√§ngija elud saavad otsa v√µi kui l√µigatakse pooleks pomm. Pommi
pooleksl√µikamisega tegelesime me eelmises punktis, ent hetkeseisuga pole meil veel s√ºsteemi, mis automaatselt
kontrolliks, kas m√§ngija elud on nulli j√µudnud, ning seej√§rel m√§ng l√µpetada.

Endiselt toimetame failis `fruit_ninja.py`. Seekord otsi √ºles `def update()` funktsioon.
Kui elud (`self.lives`) saavad nulli (v√µi j√§√§vad alla nulli, v√µimalike bugide v√§ltimiseks), siis:

- M√§√§rake m√§ngu oleku (`self.state`) v√§√§rtuseks `STATE_GAME_OVER`, et m√§ng oleks l√µppenud.
- T√ºhjendage puuviljade nimekiri (`self.fruits`), et k√µik puuviljad kaoksid ekraanilt.

### üèÜ Parima skoori salvestamine

Kui m√§ngija saavutab uue parima skoori, siis tuleb see salvestada faili, et j√§rgmine kord m√§ngu k√§ivitades viimane
parim skoor kaduma ei l√§heks.

Ja taaskord muudame faili `fruit_ninja.py`. Otsi sealt √ºles funktsioon `def save_highscore()`. Siin tuleb teha j√§rgmist:

1. Avage fail `"highscore.txt"` kirjutamisre≈æiimis. Selle kohta v√µib rohkem lugeda n√§iteks [PyDocist](https://pydoc.pages.taltech.ee/input_output/write_to_file/writing-into-existing-file.html).
2. Kirjutage praegune parim skoor (`self.highscore`) faili. Enne kirjutamist tuleb see konverteerida `str()` meetodi,
   abil s√µneks (string), kuna faili kirjutamine n√µuab s√µne andmet√º√ºpi.

### üîä Heliefektide lisamine

Et m√§ngu huvitavamaks muuta, saame lisada erinevaid heliefekte, nagu taustamuusika, pommide l√µhkemine ja puuviljade
pooleksl√µikamine. Esiteks peame sisse laadima helifailid, et saaksime neid m√§ngu jooksul m√§ngida.

Ava fail `resources.py`, ning lisa sinna muutujad k√µigi soovitud helide jaoks. Abiks vaata, kuidas on loodud muutuja
`flute_sound`. K√µik meie poolt loodud helifailid v√µid leida kaustast `"assets/sounds"`, ning kui soovid kasutada hoopis
enda helifaile, siis paiguta need sinnasamasse kausta!

Failis `resources.py` v√µiks sisse laadida j√§rgmised helid:

1. Men√º√º taustamuusika (`soundtrack`);
2. M√§ngu taustamuusika (`ambience`);
3. Pommi viskamine (`bomb_throw`);
4. Tavaline puuvilja viskamine (`fruit_throw`);
5. Pommi l√µhkemine (`explosion_sound`);
6. Puuvilja l√µikamine (`fruit_slice`);
7. Puuvilja kaotamine (`miss_sound`).

Seej√§rel mine faili `fruit_ninja.py` ja lisa need heliefektid √µigesse kohta, kus need peaksid m√§ngima. Paljud sobivad
kohad oleme me sinu jaoks juba √ºles otsinud, ning need on koodis m√§rgitud kommentaariga
`# TODO: Play the ... sound here!`.

Et heliefekti m√§ngida, pead kutsuma vastava heliefekti muutuja alt v√§lja `.play()` meetodi.

N√§iteks, et m√§ngida `flute_sound`-i, kirjutasime me m√§ngukoodi, et kui m√§ngija alustab uut m√§ngu, siis ...
```py
flute_sound.play()
```

Taustamuusika v√µiks j√§√§da end p√§rast laulu l√µppemist kordama. Selleks saame `.play()` meetodile anda kaasa parameetri,
mis √ºtleb talle, mitu korda see lugu end kordama peaks. Kui soovime, et lugu j√§√§ks end l√µpmatult kordama, siis tuleks
selle parameetri v√§√§rtuseks panna `-1`.
```py
soundtrack.play(-1)
```

### ‚≠ê Boonus√ºlesanded
- üëë Tee nii, et skoori suurenedes l√§heks m√§ng kiiremaks v√µi raskemaks.
- üëë Lisa m√§ngu uue taustaga level
- üëë Vaheta v√§lja m√µni heliefekt
- üëë Lisa uusi puuvilju
- üëë Lisa visuaalseid efekte (n√§iteks puuviljadele "pooleks minemise" animatsioon v√µi pommile plahvatamise animatsioon)