![Fruit Ninja - init2025 edition](images/logo.png "Fruit Ninja - init2025 edition")

# init 2025 - m√§ngu t√∂√∂tuba

- [Abivahendid](#abivahendid)
- [Sissejuhatus](#sissejuhatus)
- [√úlesanded](#%C3%BClesanded)
  - [üêç PyGame paigaldamine](#-pygame-paigaldamine)
  - [üê¶ Linnu loomine](#-linnu-loomine)
  - [ü¶Ö Linnulennu loomine](#-linnulennu-loomine)
  - [üèÉ‚Äç‚ôÇÔ∏èüí® Torud liikuma](#%EF%B8%8F-torud-liikuma)
  - [üëπ Uute torude loomine](#-uute-torude-loomine)
  - [üî¢ Skoori arvutamine](#-skoori-arvutamine)
  - [üîä Heliefektide lisamine](#-heliefektide-lisamine)
  - [‚≠ê Boonus√ºlesanded](#-boonus%C3%BClesanded)

## Abivahendid
K√µige olulisem abivahend selles t√∂√∂toas on **oskus k√ºsida k√ºsimusi**. K√ºsimusi soovitame julgelt k√ºsida klassis ringi liikuvate **abi√µppej√µudude k√§est**, kes on meeleldi valmis vastama k√µigile k√ºsimustele, mis tekkida v√µivad. √Ñra tunned abi√µppej√µu musta TalTechi T-s√§rgi v√µi pusa j√§rgi. Kui abi√µppej√µud Sinu k√ºsimusele vastata ei oska, siis tasub appi v√µtta [**Dr. Google**](https://google.ee). V√§ga suure t√µen√§osusega on keegi sama probleemiga juba maadelnud, ning sellele ka lahenduse leidnud. Veel v√µid abi leida [PyGame ametlikust dokumentatsioonist](https://www.pygame.org/docs/). Ning kui k√µigile abivahenditele vaatamata siiski mingi asjaga h√§tta j√§√§d, siis meie projekti kaustast [`solutions`](https://github.com/taltech-coding/init-pygame-2025/tree/main/solutions) v√µid leida ka √ºlesannete koostajate lahendused. Tunnis kasutatud slaidiesitlust on v√µimalik j√§rele vaadata [siit](https://docs.google.com/presentation/d/1Tx6Us4cHqSNCZh6fkEnREpzOUHxgPIb2akcuWgAFb8Q/edit)!

## Sissejuhatus
Oled praktikant ja sinu √ºlesandeks on anda viimane lihv tulevasele AAAA m√§ngule "Fruit Ninja - init2025 edition"!

Aga oh aeg - pool koodi on kogemata √§ra kustunud, sest √ºks t√∂√∂tajatest unustas oma muudatused salvestada!

√ïnneks on j√§√§nud alles varasemad arendaja juhised koodi dokumentatsioonis, seega saad selle abil koodi uuesti valmis kirjutada ja m√§ngu j√µuab veel √µigel ajal Steami √ºles panna!

M√§ng on loodud m√§ngumootor [PyGame](https://www.pygame.org/docs/) abil.

## √úlesanded

Oleme sulle ette valmistanud √ºlesanded ning ka lahendamiseks vajalikud juhtn√∂√∂rid. Kui vajad abi, t√µsta julgelt k√§si üôã‚Äç‚ôÄÔ∏è v√µi k√ºsi Dr. Google-ilt. Peaasi on see, et t√§na siit midagi √µpiksid!

### üêç PyGame paigaldamine

Enne programmeerima hakkamist tuleb meil avada koodit√∂√∂tlusprogramm PyCharm, laadida alla meie kood, ning paigaldada PyGame. K√µik kolm sammu teeme koos tunnis l√§bi. PyGame paigaldamiseks on vajalik avada PyCharmis Terminal (all vasakul, n√§eb v√§lja nagu `>_`. Sinna tuleb sisestada k√§sklus `pip install pygame` ning vajutada ENTER. Kui tekib mingi probleem, siis t√µsta julgelt k√§si, k√µik abi√µppej√µud ongi siin selleks, et teid aidata! P√§rast seda saame hakata m√§ngu koodi kallal t√∂√∂d tegema. 

### üçâ Puuviljade loomine

Esiteks on meil vaja sisse laadida pilt linnukesest. Meil on sulle juba `images` kaustas ette antud pilt Agost, keda v√µid "linnukesena" kasutada: `images/bird.png`.

Et pilt sisse laadida, muudame `resources.py` faili. N√§idisena on meil juba eelnevalt muutujasse `background_img` laetud taustapilt. N√º√ºd lae ise `"images/bird.png"` v√µi m√µni muu meeldiv pilt linnupildiks sisse. Muutuja nimeks peab olema `bird_img`.

> `bird_img = ???`

Peale pildi sisselaadimist on teda vaja ekraanile ilmutada.

Et lindu ekraanile ilmutada, muudame `bird.py` faili.

Sealt otsi √ºles funktsioon `def draw():`. Kutsume selle all v√§lja meetodi `screen.blit`.

```py
screen.blit(bird_img, (self.x, self.y))
# Ilmutame ekraanile linnu x ja y koordinaatidele linnu pildi.
```

Ava PyCharmis fail `flappy_bird.py`, vajuta ‚ñ∂Ô∏è play nupule, ning n√§ed, et sul ongi ekraanil linnuke!

### ü¶Ö Puuviljad lendama

1. **Linnuke peaks gravitatsiooni tagaj√§rjel pidevalt kukkuma.**

    Linnukesel on muutuja `self.velocity`, mis n√§itab linnu kiirust y-koordinaadi suhtes. Peaksime igal kaadril e. frame'il liitma sellele kiirusele gravitatsiooni kiirenduse.

    Loo faili `constants.py` muutuja `GRAVITY` - selle v√§√§rtuseks sea `1.2`. V√µid muidugi seda v√§√§rtust timmida, et m√§ngu huvitavamaks muuta. üòâ

    Seej√§rel otsi failist `bird.py` √ºles `class Bird`. Selle all on funktsioonid, mis seonduvad linnuga. Iga kaader kutsutakse v√§lja `def update()` funktsiooni. Sinna alla pead kirjutama kiirenduse koodi!

    Lisaks `self.velocity`-le `GRAVITY` liitmise tuleb igal kaadril `self.y`-ile, ehk linnu y-koordinaadile, liita tema kiirus y-koordinaadi suhtes, ehk `self.velocity`.

    <details>
    <summary>üí° Kuidas luua, liita ja lahutada muutujaid Python-is?</summary>

    ```py
    # Loome muutuja 'x', ning seame selle v√§√§rtuseks 0.
    x = 0
    x += 5  # muutujale viie liitmine
            # x on n√º√ºd 0 + 5 = 5
    x -= 2  # muutujast kahe lahutamine
            # x on n√º√ºd 5 - 2 = 3
    # saad ka liita m√µne muu muutuja v√µrra
    teine_muutuja = 5
    x += teine_muutuja
    # x on n√º√ºd 3 + teine_muutuja = 3 + 5 = 8
    ```
    </details>

&nbsp;

2. **Kui m√§ngija vajutab t√ºhikule, peaks linnuke √ºlespoole h√ºppama.**

    Siin uuendame linnukese kiirust, kuid seekord s√§time linnu kiiruse h√ºppamise kiiruseks.

    Et PyGame arvutab koordinaate "tagurpidi" (numbrid suurenevad √ºlevalt alla liikudes), peaks √ºles liikumiseks kiirus olema negatiivne.

    Arvesta, et ekraani miinimumpunkt (0,0) asub ekraani vasakul √ºleval nurgas ja maksimumpunkt all paremal nurgas!

     ```
    # N√§idis ekraani koordinaatidest
    
    MIN----->600 (x)
    |   E   |
    |   K   |
    |   R   |
    |   A   |
    |   A   |
    |   N   |
    v------MAX
    900

    (y)
    ```

    Loo faili `constants.py` muutuja `BIRD_JUMP`, ning sea selle v√§√§rtuseks `15`.

    Sulle on faili `bird.py` valmis tehtud `def flap()` funktsioon, mida kutsutakse v√§lja siis, kui vajutatakse t√ºhikule.

    Selle funktsiooni all peaksid `self.velocity` muutujaks seadma NEGATIIVSE `BIRD_JUMP`-i v√§√§rtuse.

3. **Kui linnuke puudutab maad, peaks m√§ng l√µppema.**

    Selle jaoks tuleb realiseerida failis `bird.py` funktsioon `check_collision_with_floor()`. 
    
    √úlevalt alla liikudes y-koordinaat suureneb. Seega, juhul kui linnu y-koordinaat on suurem kui ekraani k√µrgus, millest on lahutatud linnupildi enda k√µrgus, siis tuleks tagastada `True`. Igal muul juhul tuleks tagastada `False`.

    Vastavalt eelnevatele lausetele saame sellesse funktsiooni kirjutada j√§rgneva `if` kontroll-lause:
    
    Juhul kui `self.y` on suurem kui `SCREEN_HEIGHT - 50`, siis tagasta (ehk `return`) `True`, muul juhul (`else`) tagasta `False`. 

### üèÉ‚Äç‚ôÇÔ∏èüí® Torud liikuma

Lisada `pipe.py` failis `def update():` meetodi alla koodijupp, mis iga kaader lahutab `self.x`-ist konstandi `PIPE_VELOCITY`.

Toru liikumise kiirust (`PIPE_VELOCITY`) v√µid soovi korral timmida failis `constants.py`.


### üëπ Uute torude loomine

Iga natukese aja tagant peaks tekkima ekraanile uus toru, mille vahelt peab linnuke l√§bi lendama.

Meil on j√§rjend (justkui nimekiri) torudest, mida hoitakse muutujas `pipes`. See muutuja asub failis `flappy_bird.py`. Kui soovime p√§√§seda ligi m√µnele kindlale elemendile selles j√§rjendis, siis seda saame teha \[kantsulgude\] abil.

Kui soovime saada k√§tte j√§rjendist elemendi (meil siis toru) indeksiga 0, siis peaksime kasutama viidet `pipes[0]`. Tasub t√§hele panna, et miinusm√§rgiga indeksid v√µimaldavad j√§rjendi elemente k√§tte saada "tagantpoolt". Seega viide `pipes[-1]` annab meile selle j√§rjendi viimase elemendi.

Uute torude tekitamiseks tuleb kirjutada paar rida koodi. Selleks sobiv koht on failis `flappy_bird.py`. 

> √ïiget kohta n√§itab kommentaar `# TODO: Generate new pipes`!

M√µistlik oleks n√§iteks kontrollida, kas j√§rjendi viimane element (`pipes[-1]`) on j√µudnud x-teljel koordinaadile, mis on v√§iksem kui konstandis `DISTANCE_BETWEEN_PIPES` m√§√§ratud kaugus. Viimase toru x-koordinaati saame k√ºsida viitega `pipes[-1].x`.

Meeldetuletuseks: liikudes paremalt vasakule koordinaatide numbriline suurus v√§heneb!

<details>
<summary>üí° Proovi ise m√µelda v√§lja, kuidas sellist kontrolli koodis vormistada! Kui oled oma lahenduse v√§lja m√µelnud, siis kontrolli siit, kas Sinu lahendus oli √µige.</summary>

```py
if pipes[-1].x < DISTANCE_BETWEEN_PIPES:
    # N√º√ºd on √µige aeg lisada uus toru!
```
</details>

&nbsp;

Juhul kui eelnevalt kirjeldatud tingimus on t√µene, siis j√§relikult on k√§tte j√µudnud √µige aeg tekitada uus toru! Selleks kasutame j√§rjendi meetodit `append`, et lisada j√§rjendi l√µppu uus toru. Sobiv koodijupp oleks n√§iteks `pipes.append(Pipe())`. Meenutame veel, et kui m√µni koodirida on meil l√µppenud kooloniga `:`, siis j√§rgnevat rida peame koodivea v√§ltimiseks alustama taandreaga (selleks saad kasutada klahvi Tab).

### üî¢ Skoori arvutamine

Torude vahelt l√§bimine peaks m√§ngija skoorile andma plusspunkti.

Esiteks on meil vaja kirjutada kood, mis arvutab v√§lja, kas m√§ngija on torust l√§bi saanud.

Meil on teada, kus asuvad toru ja linnuke koordinaatteljestikul. Siis kui linnukese asukoht x-teljel on suurem kui toru keskpunkt, lisame m√§ngijale punkti.

Torul on `has_been_passed` muutuja, mis v√µib olla `True` v√µi `False` ehk t√µene v√µi v√§√§r.

Esiteks otsi failist `flappy_bird.py` √ºles koodijupp, kus me uuendame iga toru asukohta, ning joonistame igat toru ekraanile. 

<details>
<summary>üßê See peaks v√§lja n√§gema umbes selline:</summary>

```py
for pipe in pipes.copy():
    pipe.update()
    pipe.draw()

    # TODO: Detect if bird is currently between pipes.
    # If yes, add +1 to the score.
    # Don't forget to update the pipe's has_been_passed value to True!
    # You can try to play a point sound here as well.
```

</details>

&nbsp;

Selle `for` loopi alla, kus me igast torust √ºle k√§ime, peaksime lisama j√§rgneva `if` kontrolli:

Kui `has_been_passed` on `False` ning `bird.x` on suurem kui `pipe.x + 25`, s√§ti, et `has_been_passed` on t√µene ehk `True`. Seej√§rel peaksime ka `score` muutujale liitma √ºhe. V√µiks ka m√§ngida mingit heliefekti? ü§î


### üîä Heliefektide lisamine

Esiteks peame sisse laadima helifailid, et saaksime neid m√§ngu jooksul m√§ngida.

Ava fail `resources.py`, ning lisa sinna `hurt_sound` ja `point_sound` muutujad. Abiks vaata, kuidas `flap_sound` on loodud.

|**muutuja nimi**|**heliefekti asukoht**|
|-|-|
|`hurt_sound`|`sounds/hurt.wav`|
|`point_sound`|`sounds/point.wav`|

&nbsp;

Failis `flappy_bird.py` on sulle ette toodud kohad, kus v√µiks m√µni heliefekt m√§ngida!
Nendes kohtades on kirjas `# TODO: Play a sound!`

Et heliefekti m√§ngida, pead kutsuma vastava heliefekti muutuja alt v√§lja `.play()` meetodi.

N√§iteks, et m√§ngida `flap_sound`-i, kirjutasime me m√§ngukoodi, et kui m√§ngija vajutab t√ºhikule, siis ...
```py
flap_sound.play()
```

### ‚≠ê Boonus√ºlesanded
- üëë Tee nii, et skoori suurenedes l√§heks m√§ng kiiremaks v√µi raskemaks.
- üëë Tee nii, et liikumisel taust vaikselt kaasa liiguks. *(Parallax scrolling)*
- üëë Lisa maapind.
- üëë Tee nii, et lind vaatab liikumise suunas √ºles/alla.
- üëë Lisa visuaalseid efekte? :)